Fix Coursor position detection
Improve performance
